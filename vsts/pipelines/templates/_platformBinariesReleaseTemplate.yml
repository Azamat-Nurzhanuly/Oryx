parameters:
  destinationSdkStorageAccountName: 'oryxsdksstaging'
  sourceFolder: ''

steps:

- task: AzureCLI@2
  displayName: Upload files to Azure Storage
  inputs:
    azureSubscription: 'Oryx (e13e3c2a-b6ed-4969-875a-28bec9f4513f)'
    scriptPath: ./vsts/scripts/publishFilesToAzureStorage.sh
    args: ${{ parameters.destinationSdkStorageAccountName }}

- task: UseDotNet@2
  displayName: 'Use .NET Core SDK 7.x'
  inputs:
    version: 7.0.306

- task: AzureCLI@2
  displayName: 'Test Dev storage account'
  env:
    ORYX_TEST_SDK_STORAGE_URL: https://${{ parameters.destinationSdkStorageAccountName }}.blob.core.windows.net
  inputs:
    azureSubscription: 'Oryx (e13e3c2a-b6ed-4969-875a-28bec9f4513f)'
    scriptPath: ./build/testIntegration.sh
    args: StorageAccountTests=Dev